# VL.RU/off - Backend API

Backend —á–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ "–û—Ç–∫–ª—é—á–µ–Ω–∏—è –≤–æ–¥—ã –∏ —Å–≤–µ—Ç–∞ –≥–æ—Ä–æ–¥–∞ –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫" –¥–ª—è –æ—Å–µ–Ω–Ω–µ–π –ø—Ä–æ–µ–∫—Ç–Ω–æ–π —à–∫–æ–ª—ã –§–∞—Ä–ø–æ—Å—Ç 18.10.2025 - 01.11.2025. REST API —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—Ç–∫–ª—é—á–µ–Ω–∏—è—Ö –∫–æ–º–º—É–Ω–∞–ª—å–Ω—ã—Ö —É—Å–ª—É–≥.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **Go 1.24.7** –∏–ª–∏ –≤—ã—à–µ ([—Å–∫–∞—á–∞—Ç—å —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://golang.org/dl/))
- **SQLite3**

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Go
```bash
go version
```
–î–æ–ª–∂–Ω–∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è –≤–µ—Ä—Å–∏—è Go 1.24.7 –∏–ª–∏ –≤—ã—à–µ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)**
```bash
git clone https://github.com/OCAGO/Farpost-Backend.git
cd vlru-prsch
```

2. **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
```bash
make run
```
–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ go
```bash
go run cmd/vlru-prsch/main.go --config=config/local.yaml
```
–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ http://localhost:1234

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
### –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ config/local.yaml:
```yaml
env: "local"
storage_path: "./storage/storage.db"
http_server: 
  address: "localhost:1234"
  timeout: 4s
  iddle_timeout: 60s
```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Swagger/OpenAPI** –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

### üìñ –î–æ—Å—Ç—É–ø –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:1234/swagger/

### üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å API

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**:
```bash
make run
```

2. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
```text
http://localhost:1234/swagger/
```

3. **–ò–∑—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ endpoints**
- –í—Å–µ endpoints –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–æ–¥ –±–∞–∑–æ–≤—ã–º –ø—É—Ç–µ–º `/off`

- –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –ø–æ–ª–Ω—ã–µ —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤

- –î–æ—Å—Ç—É–ø–Ω–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- –Ø–∑—ã–∫: **Go 1.24.7**
- –§—Ä–µ–π–º–≤–æ—Ä–∫: **Chi Router**
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: **SQLite3**
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: **Cleanenv**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: **Structured logging (slog)**

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```text
vlru-prsch/
‚îú‚îÄ‚îÄ cmd/vlru-prsch/main.go  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ http-server/        # HTTP handlers –∏ middleware
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ handlers/       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ endpoints
‚îÇ   ‚îú‚îÄ‚îÄ lib/                # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ storage/            # –°–ª–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
‚îú‚îÄ‚îÄ config/                 # –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ storage/                # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
#### –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- **github.com/go-chi/chi/v5** - HTTP —Ä–æ—É—Ç–µ—Ä
- **github.com/go-chi/cors** - CORS middleware
- **github.com/mattn/go-sqlite3** - SQLite –¥—Ä–∞–π–≤–µ—Ä
- **github.com/ilyakaznacheev/cleanenv**- —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
### Make –∫–æ–º–∞–Ω–¥—ã
```bash
make run    # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```
### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
#### –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–∞–∑–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:
- **local**: –ö—Ä–∞—Å–∏–≤—ã–π —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥
- **dev**: JSON —Ñ–æ—Ä–º–∞—Ç (Debug)
- **prod**: JSON —Ñ–æ—Ä–º–∞—Ç (Info)
### CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
#### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∑–∞–ø—Ä–æ—Å—ã —Å:
- http://localhost:*
- http://127.0.0.1:*
- http://0.0.0.0:*

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **SQLite** –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –≥–æ—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ö–µ–π—Å_–ê–Ω–∞–ª–∏—Ç–∏–∫–∞.db), –ø—É—Ç—å –∫ –∫–æ—Ç–æ—Ä–æ–π —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```yaml
storage_path: "./storage/storage.db"
```

## üöÄ –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏—è:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ env: "prod" –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## ‚ùå –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
### –ï—Å–ª–∏ Go –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
1. –°–∫–∞—á–∞–π—Ç–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–æ–≥–ª–∞—Å–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è –≤–∞—à–µ–π –û–°
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É: ```go version```
### –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ make –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ Go:
```bash
go run cmd/vlru-prsch/main.go --config=config/local.yaml
```